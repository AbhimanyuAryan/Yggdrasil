diff --git a/src/transports/ssh.c b/src/transports/ssh.c
index 471c3273ed..5ed7278ed6 100644
--- a/src/transports/ssh.c
+++ b/src/transports/ssh.c
@@ -636,7 +636,15 @@ post_extract:
 
 		cert_ptr = &cert;
 
-		error = t->owner->certificate_check_cb((git_cert *) cert_ptr, 0, urldata.host, t->owner->message_cb_payload);
+		if (atoi(urldata.port) == SSH_DEFAULT_PORT) {
+			host_and_port = urldata.host;
+		} else {
+			size_t n = strlen(urldata.host) + strlen(urldata.port) + 2;
+			host_and_port = alloca(n);
+			sprintf(host_and_port, "%s:%s", urldata.host, urldata.port);
+		}
+
+		error = t->owner->certificate_check_cb((git_cert *) cert_ptr, 0, host_and_port, t->owner->message_cb_payload);
 
 		if (error < 0 && error != GIT_PASSTHROUGH) {
 			if (!git_error_last())
